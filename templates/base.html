<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}NuGenBioPython{% endblock %}</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon.png') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/custom.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/gradient-buttons.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/performance-fix.css') }}" rel="stylesheet">
    <style>
        .nav-section-header {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            color: #6c757d;
            margin-top: 1rem;
            border-bottom: 1px solid #dee2e6;
        }
        .nav-item .nav-link {
            padding-left: 1.5rem;
        }

        /* Prevent flashing during page load */
        .preload *,
        .preload *::before,
        .preload *::after {
            transition: none !important;
            animation: none !important;
            animation-duration: 0s !important;
        }

        /* Prevent active state flashing on navigation */
        .nav-link.active {
            transition: none !important;
        }
    </style>
    <script>
        // Disable transitions on page load to prevent flashing
        document.documentElement.classList.add('preload');
        window.addEventListener('load', function() {
            // Re-enable transitions after page loads
            setTimeout(function() {
                document.documentElement.classList.remove('preload');
            }, 100);
        });

        // Detect scrolling to disable transitions during scroll
        let scrollTimer = null;
        let isScrolling = false;

        window.addEventListener('scroll', function() {
            if (!isScrolling) {
                document.body.classList.add('scrolling');
                isScrolling = true;
            }

            clearTimeout(scrollTimer);
            scrollTimer = setTimeout(function() {
                document.body.classList.remove('scrolling');
                isScrolling = false;
            }, 150);
        }, { passive: true });
    </script>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar-container">
        <div class="sidebar-header">
            <a href="{{ url_for('index') }}" class="sidebar-brand">
                <i class="fas fa-dna"></i>
                NuGenBioPython
            </a>
            <a href="https://github.com/AnthonyNystrom/NuGenBioPython" target="_blank" class="github-link">
                <i class="fab fa-github"></i>
                Open Source
            </a>
        </div>

        <nav class="sidebar-nav">
            <!-- Home -->
            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'index' %}active{% endif %}" href="{{ url_for('index') }}">
                    <i class="fas fa-home"></i>
                    Dashboard
                </a>
            </div>

            <!-- Core Tools Section -->
            <div class="nav-section-header">
                <i class="fas fa-flask"></i> Core Tools
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'sequence_tools' %}active{% endif %}" href="{{ url_for('sequence_tools') }}">
                    <i class="fas fa-dna"></i>
                    Sequence Analysis
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'seqio_tools' %}active{% endif %}" href="{{ url_for('seqio_tools') }}">
                    <i class="fas fa-file-import"></i>
                    File I/O (SeqIO)
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'alignment_tools' %}active{% endif %}" href="{{ url_for('alignment_tools') }}">
                    <i class="fas fa-align-center"></i>
                    Pairwise Alignment
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'structure_tools' %}active{% endif %}" href="{{ url_for('structure_tools') }}">
                    <i class="fas fa-cube"></i>
                    Structure Analysis
                </a>
            </div>

            <!-- Comparison & Evolution Section -->
            <div class="nav-section-header">
                <i class="fas fa-project-diagram"></i> Comparison & Evolution
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'phylo_tools' %}active{% endif %}" href="{{ url_for('phylo_tools') }}">
                    <i class="fas fa-tree"></i>
                    Phylogenetics
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'blast_tools' %}active{% endif %}" href="{{ url_for('blast_tools') }}">
                    <i class="fas fa-rocket"></i>
                    BLAST Search
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'motifs_tools' %}active{% endif %}" href="{{ url_for('motifs_tools') }}">
                    <i class="fas fa-search-plus"></i>
                    Motif Analysis
                </a>
            </div>

            <!-- Databases & Parsing Section -->
            <div class="nav-section-header">
                <i class="fas fa-database"></i> Databases & Parsing
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'database_tools' %}active{% endif %}" href="{{ url_for('database_tools') }}">
                    <i class="fas fa-server"></i>
                    Database & Search
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'kegg_tools' %}active{% endif %}" href="{{ url_for('kegg_tools') }}">
                    <i class="fas fa-route"></i>
                    KEGG
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'searchio_tools' %}active{% endif %}" href="{{ url_for('searchio_tools') }}">
                    <i class="fas fa-search"></i>
                    SearchIO Parser
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'swissprot_tools' %}active{% endif %}" href="{{ url_for('swissprot_tools') }}">
                    <i class="fas fa-university"></i>
                    SwissProt/UniProt
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'unigene_tools' %}active{% endif %}" href="{{ url_for('unigene_tools') }}">
                    <i class="fas fa-sitemap"></i>
                    UniGene Analysis
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'biodata_tools' %}active{% endif %}" href="{{ url_for('biodata_tools') }}">
                    <i class="fas fa-table"></i>
                    BioData
                </a>
            </div>

            <!-- Genomic Features Section -->
            <div class="nav-section-header">
                <i class="fas fa-tags"></i> Genomic Features
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'features_tools' %}active{% endif %}" href="{{ url_for('features_tools') }}">
                    <i class="fas fa-bookmark"></i>
                    Sequence Features
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'restriction_tools' %}active{% endif %}" href="{{ url_for('restriction_tools') }}">
                    <i class="fas fa-cut"></i>
                    Restriction Enzymes
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'genomediagram_tools' %}active{% endif %}" href="{{ url_for('genomediagram_tools') }}">
                    <i class="fas fa-chart-area"></i>
                    Genome Diagrams
                </a>
            </div>

            <!-- Analysis & Statistics Section -->
            <div class="nav-section-header">
                <i class="fas fa-chart-line"></i> Analysis & Statistics
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'clustering_tools' %}active{% endif %}" href="{{ url_for('clustering_tools') }}">
                    <i class="fas fa-project-diagram"></i>
                    Clustering Analysis
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'popgen_tools' %}active{% endif %}" href="{{ url_for('popgen_tools') }}">
                    <i class="fas fa-users"></i>
                    Population Genetics
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'pathway_tools' %}active{% endif %}" href="{{ url_for('pathway_tools') }}">
                    <i class="fas fa-share-alt"></i>
                    Pathway Analysis
                </a>
            </div>

            <div class="nav-item">
                <a class="nav-link {% if request.endpoint == 'hmm_tools' %}active{% endif %}" href="{{ url_for('hmm_tools') }}">
                    <i class="fas fa-brain"></i>
                    Advanced Tools (HMM)
                </a>
            </div>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-container">
        <div class="main-content">
            {% block content %}{% endblock %}

            <!-- Footer -->
            <div class="footer">
                <div class="row">
                    <div class="col-md-8">
                        <h6>NuGenBioPython</h6>
                        <p>A comprehensive BioPython web interface for NuGenBio research and analysis</p>
                        <p>
                            Copyright Â© 2025 Anthony Nystrom. Licensed under the
                            <a href="https://opensource.org/licenses/MIT" target="_blank">MIT License</a>.
                        </p>
                    </div>
                    <div class="col-md-4">
                        <p>
                            <a href="https://github.com/AnthonyNystrom/NuGenBioPython" target="_blank">
                                <i class="fab fa-github"></i> View Source
                            </a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showLoading(buttonId) {
            const btn = document.getElementById(buttonId);
            if (btn) {
                btn.disabled = true;
                btn.innerHTML = '<span class="spinner-border spinner-border-sm"></span> Processing...';
            }
        }

        function hideLoading(buttonId, originalText) {
            const btn = document.getElementById(buttonId);
            if (btn) {
                btn.disabled = false;
                btn.innerHTML = originalText;
            }
        }

        function showAlert(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;

            const container = document.querySelector('.main-content');
            if (container) {
                container.insertBefore(alertDiv, container.firstChild);

                // Auto-remove after 5 seconds
                setTimeout(() => {
                    if (alertDiv.parentNode) {
                        alertDiv.remove();
                    }
                }, 5000);
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    {% block scripts %}{% endblock %}
</body>
</html>
